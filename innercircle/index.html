<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inner Circle Membership Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        /* 폰트 크기 18px 표준 */
        html { font-size: 18px; }
        @media (max-width: 768px) { html { font-size: 16px; } }

        /* 네이비 & 골드 프리미엄 테마 */
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #0f172a; color: #cbd5e1; line-height: 1.6; }
        
        /* 스크롤바 */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }

        /* 유틸리티 */
        .text-gold { color: #fbbf24; }
        .border-gold { border-color: #d97706; }
        .bg-gold { background-color: #d97706; }
        
        /* 카드 스타일 */
        .guide-card { 
            background-color: #1e293b; 
            border: 1px solid #334155; 
            border-radius: 1rem; 
            padding: 1.5rem; 
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        .guide-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.3);
            border-color: #475569;
        }
        
        /* 기업 홈페이지 특별 카드 (Hover 효과 추가) */
        .special-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #312e81; /* Indigo-900 */
        }
        .special-card:hover {
            transform: translateY(-4px) scale(1.01);
            border-color: #d97706; /* Amber-600 (Gold) */
            box-shadow: 0 20px 40px -10px rgba(217, 119, 6, 0.15);
        }
        
        /* 버튼 스타일 */
        .btn-action { 
            display: inline-flex; align-items: center; justify-content: center; gap: 0.4rem;
            padding: 0.6rem 1rem; border-radius: 0.5rem; font-size: 0.9rem; font-weight: 700;
            background-color: #334155; color: #cbd5e1; border: 1px solid #475569; transition: all 0.2s;
            white-space: nowrap; /* 버튼 깨짐 방지 */
        }
        .btn-action:hover { background-color: #475569; color: white; border-color: #94a3b8; }
        
        .btn-gold { 
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%); 
            color: white; border: none; font-weight: 800;
        }
        .btn-gold:hover { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #0f172a; }

        /* 섹션 타이틀 */
        .section-title { 
            font-size: 1.35rem; font-weight: 800; color: white; margin-bottom: 1.2rem; 
            display: flex; align-items: center; gap: 0.5rem; border-left: 4px solid #d97706; padding-left: 1rem;
        }
        
        /* 필터 버튼 */
        .filter-btn.active { background-color: #d97706; color: white; border-color: #d97706; }
        
        .glass-header { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid #334155; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="antialiased selection:bg-amber-500 selection:text-slate-900">

    <!-- 메인 대시보드 -->
    <div id="dashboard-section" class="min-h-screen pb-20 bg-slate-900">
        <!-- 헤더 -->
        <header class="glass-header sticky top-0 z-50">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg bg-amber-600 flex items-center justify-center text-white text-xl shadow-lg">
                        <i class="fas fa-gem"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-white tracking-tight"><span id="user-name-display" class="text-amber-400"></span> 전문위원님</h1>
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">Inner Circle Member</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="showArchive()" class="hidden sm:flex items-center gap-2 bg-slate-800 border border-slate-700 text-amber-500 hover:text-white hover:border-amber-500 px-5 py-2 rounded-full transition-all text-sm font-bold shadow-sm">
                        <i class="fas fa-folder-open"></i> 나만의 자료실
                    </button>
                    <button onclick="showArchive()" class="sm:hidden bg-slate-800 text-amber-500 border border-slate-700 w-10 h-10 rounded-full flex items-center justify-center">
                        <i class="fas fa-folder-open"></i>
                    </button>
<button onclick="openPwModal()" class="hidden sm:flex items-center gap-2 text-slate-500 hover:text-white transition-colors text-sm font-bold px-3">
                         <i class="fas fa-key"></i> 비번변경
                    </button>
                    <button onclick="logout()" class="flex items-center gap-2 text-slate-500 hover:text-white transition-colors text-sm font-bold px-3">
                        <span class="hidden sm:inline">로그아웃</span> <i class="fas fa-sign-out-alt text-lg"></i>
                    </button>
                </div>
            </div>
        </header>

        <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
            
<div id="inner-notice-box" class="hidden bg-slate-800/80 rounded-xl border-l-4 border-amber-500 overflow-hidden relative transition-all duration-300 mb-6">
                <div class="p-5 pb-2">
                    <div class="flex items-start gap-4">
                        <div class="p-1 shrink-0"><i class="fas fa-bell text-amber-400 text-xl animate-pulse"></i></div>
                        <div class="w-full relative">
                            <div class="flex items-center justify-between mb-1">
                                <span class="text-amber-500 text-xs font-bold uppercase tracking-wider">Notice</span>
                                <span id="notice-yearmonth" class="text-slate-500 text-xs font-bold"></span>
                            </div>
                            <h4 id="notice-title" class="text-white font-bold text-base mb-2"></h4>
                            
                            <div id="notice-content-wrapper" class="relative max-h-[3.6rem] overflow-hidden transition-[max-height] duration-500 ease-in-out">
                                <p id="notice-text" class="text-white text-sm sm:text-base leading-relaxed benefit-text whitespace-pre-line"></p>
                                
                                <div id="notice-gradient" class="absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-slate-800 to-transparent"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex border-t border-slate-700">
                    <button id="notice-toggle-btn" onclick="toggleNotice()" class="flex-1 py-2 bg-slate-700/50 hover:bg-slate-700 text-slate-400 hover:text-white text-xs font-bold transition-colors flex items-center justify-center gap-1">
                        <span>더 보기</span> <i class="fas fa-chevron-down"></i>
                    </button>
                    <button onclick="openNoticeHistory()" class="flex-1 py-2 bg-amber-600/20 hover:bg-amber-600/40 text-amber-400 hover:text-amber-300 text-xs font-bold transition-colors flex items-center justify-center gap-1 border-l border-slate-700">
                        <i class="fas fa-history"></i> <span>지난 공지사항</span>
                    </button>
                </div>
            </div>

<div id="support-status-box" class="hidden bg-indigo-900/40 rounded-xl p-5 border border-indigo-500/30 relative mb-8">
                <div class="flex items-start gap-4">
                    <div class="p-1"><i class="fas fa-clipboard-check text-indigo-400 text-xl"></i></div>
                    <div>
                        <span class="text-indigo-400 text-xs font-bold uppercase tracking-wider mb-1 block">My Support Status</span>
                        <p id="support-text" class="text-white text-sm sm:text-base leading-relaxed font-bold"></p>
                    </div>
                </div>
            </div>

            <!-- [NEW] 특급보고서 최신 링크 섹션 -->
            <div id="special-report-box" class="hidden bg-gradient-to-r from-purple-950/80 to-slate-900/80 rounded-xl border border-purple-500/30 overflow-hidden relative transition-all duration-300 mb-6">
                <div class="p-5">
                    <div class="flex items-center justify-between gap-4">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-purple-500/20 rounded-lg shrink-0">
                                <i class="fas fa-file-signature text-purple-400 text-xl"></i>
                            </div>
                            <div>
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-purple-400 text-xs font-bold uppercase tracking-wider">특급보고서</span>
                                    <span class="bg-purple-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse">NEW</span>
                                </div>
                                <a id="special-report-link" href="#" target="_blank" class="text-white text-sm sm:text-base font-bold hover:text-purple-300 transition-colors cursor-pointer">
                                    <span id="special-report-title">로딩 중...</span>
                                </a>
                            </div>
                        </div>
                        <a id="special-report-btn" href="#" target="_blank" class="shrink-0 bg-purple-600 hover:bg-purple-500 text-white text-xs font-bold px-4 py-2.5 rounded-lg shadow-md transition-all hover:scale-105 flex items-center gap-2">
                            <span>바로가기</span> <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- [NEW] 이슈브리핑 최신 링크 섹션 -->
            <div id="issue-briefing-box" class="hidden bg-gradient-to-r from-blue-950/80 to-slate-900/80 rounded-xl border border-blue-500/30 overflow-hidden relative transition-all duration-300 mb-6">
                <div class="p-5">
                    <div class="flex items-center justify-between gap-4">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-blue-500/20 rounded-lg shrink-0">
                                <i class="fas fa-newspaper text-blue-400 text-xl"></i>
                            </div>
                            <div>
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-blue-400 text-xs font-bold uppercase tracking-wider">이슈브리핑</span>
                                    <span class="bg-blue-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse">NEW</span>
                                </div>
                                <a id="issue-briefing-link" href="#" target="_blank" class="text-white text-sm sm:text-base font-bold hover:text-blue-300 transition-colors cursor-pointer">
                                    <span id="issue-briefing-title">로딩 중...</span>
                                </a>
                            </div>
                        </div>
                        <a id="issue-briefing-btn" href="#" target="_blank" class="shrink-0 bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold px-4 py-2.5 rounded-lg shadow-md transition-all hover:scale-105 flex items-center gap-2">
                            <span>바로가기</span> <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- [Section 1] 내 전문위원 홈페이지 (가로 배치) -->
<section class="guide-card border-amber-500/30 relative overflow-hidden p-8">
                <div class="absolute top-0 right-0 w-64 h-64 bg-amber-500/5 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"></div>
                
                <div class="relative z-10 flex flex-col lg:flex-row items-center justify-between gap-6">
                    <div class="flex items-center gap-4 mb-2 lg:mb-0 w-full lg:w-auto shrink-0">
                        <div class="w-16 h-16 rounded-2xl bg-slate-950 flex items-center justify-center border border-slate-700 shadow-inner shrink-0">
                            <i class="fas fa-laptop-code text-amber-400 text-3xl"></i>
                        </div>
                        <div>
                            <h2 class="text-lg md:text-2xl font-bold text-white mb-1">내 전문위원 홈페이지</h2>
                            <p class="text-sm text-slate-400">Personal Branding Site</p>
                        </div>
                    </div>

                    <div class="flex flex-col items-center w-full lg:w-auto gap-3">
                        <div class="bg-slate-950/60 rounded-xl px-8 py-4 border border-slate-700 flex flex-col sm:flex-row items-center gap-6 sm:gap-12 w-full justify-center shadow-inner">
                            <div class="flex items-center gap-3">
                                <span class="text-[10px] text-slate-500 font-bold tracking-wider bg-slate-900 px-2 py-1 rounded uppercase">User ID</span>
                                <span id="icm-id-display" class="text-amber-400 font-bold text-xl tracking-wide">loading...</span>
                            </div>
                            <div class="hidden sm:block w-px h-8 bg-slate-700"></div>
                            <div class="flex items-center gap-3">
                                <span class="text-[10px] text-slate-500 font-bold tracking-wider bg-slate-900 px-2 py-1 rounded uppercase">Password</span>
                                <span id="icm-pw-display" class="text-white font-bold text-xl tracking-wide">...</span>
                            </div>
                        </div>

                        <div class="w-full bg-slate-800/50 border border-slate-700/50 rounded-lg p-3 text-center sm:text-left flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4">
                            <span class="text-slate-400 text-xs font-bold shrink-0"><i class="fas fa-info-circle text-amber-500 mr-1"></i> 정보 변경 안내</span>
                            <div class="text-[13px] text-slate-500 leading-snug">
                                <p><strong class="text-slate-400">프로필:</strong> 홈페이지 로그인 후 하단 <span class="text-slate-300">'전문위원 정보 등록/관리'</span></p>
                                <p><strong class="text-slate-400">비밀번호:</strong> 홈페이지 로그인 후 하단 <span class="text-slate-300">'비밀번호 변경'</span></p>
<p><strong class="text-slate-400">*위 비밀번호는 초기 비밀번호 입니다. 비밀번호를 변경하였다면 변경된 비밀번호로 로그인 부탁드립니다.</strong></span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-col gap-3 w-full lg:w-auto shrink-0">
                        <a id="btn-icm-link" href="#" target="_blank" class="w-full btn-gold px-8 py-3.5 rounded-xl shadow-lg hover:scale-105 transition-transform flex items-center justify-center gap-2 text-base">
                            <span>홈페이지 접속</span> <i class="fas fa-external-link-alt"></i>
                        </a>

                        <a href="https://youtu.be/b3pPujI6YZU" target="_blank" class="w-full bg-gradient-to-r from-rose-700 to-pink-800 hover:from-rose-600 hover:to-pink-700 text-white border border-rose-900 px-8 py-3.5 rounded-xl shadow-lg hover:scale-105 transition-transform flex items-center justify-center gap-2 text-base font-bold">
                            <span>활용안내 영상</span> <i class="fab fa-youtube text-lg"></i>
                        </a>
                    </div>
                </div>
            </section>

            <!-- [Section 2] 전문성 (Expertise) -->
            <section>
                <h3 class="section-title">전문성 <span class="text-sm text-slate-500 font-normal ml-2">Expertise</span></h3>
                
                <!-- 한국FP센터 -->
<div class="guide-card">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                        <div class="flex items-center gap-3 w-full md:w-auto">
                            <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center shrink-0">
                                <span class="text-[10px] text-black font-black leading-none text-center">KFP<br>CENTER</span>
                            </div>
                            <div>
                                <h4 class="font-bold text-white text-lg">(주)한국FP센터</h4>
                                <p class="text-sm text-slate-400">금융/재무 컨설팅의 중심</p>
                            </div>
                        </div>

                        <div class="flex flex-col items-center md:items-end gap-3 w-full md:w-auto">
                            <div class="flex flex-wrap gap-2 justify-center md:justify-end w-full">
                                <a href="https://www.kfpcenter.co.kr/" target="_blank" class="btn-action">사이트 접속</a>
                                <a href="https://www.kfpcenter.co.kr/child/member/join_agree.php" target="_blank" class="btn-action">회원가입</a>
                                <a href="https://www.kfpcenter.co.kr/child/sub/lecture/free/" target="_blank" class="btn-action text-amber-500 hover:text-white border-amber-500/50 hover:border-amber-500 hover:bg-amber-500">
                                    <i class="fas fa-play-circle mr-1"></i> 강의 다시보기
                                </a>
                            </div>

                            <div class="bg-slate-950/50 border border-slate-700/50 rounded-lg px-3 py-2 text-center md:text-right max-w-md">
                                <p class="text-[11px] text-slate-400 leading-relaxed">
                                    <span class="text-amber-500 font-bold mr-1"><i class="fas fa-map-marker-alt"></i> 강의영상 위치:</span>
                                    로그인 후 상단 메뉴 <span class="text-slate-200 font-bold">'이너서클 멤버십'</span> &gt; <span class="text-slate-200 font-bold">'강의'</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 전문가 협업 & 전문위원 홈페이지 (2열) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="guide-card mb-0 flex flex-col">
                        <h4 class="font-bold text-white text-lg mb-2 flex items-center gap-2"><i class="fas fa-handshake text-amber-500"></i> 전문가 협업 네트워크</h4>
                        <p class="text-sm text-slate-400 mb-1 flex-grow">삼일회계법인, ERA코리아 등 유수의 40여 전문가 집단과 함께 기업고객의 문제해결에 참여하실 수 있습니다.</p>
                                <p class="text-xs text-amber-600 mb-4">※ 브로슈어 제작은 별도 비용이 추가됩니다.</p>
                        <div class="flex flex-col gap-2 mt-auto">
                            <a href="https://drive.google.com/file/d/1WHtd-tQS5jdhadMRfrnK3UN8xiiMC7eW/view?usp=sharing" target="_blank" class="btn-action justify-center">전문가 네트워크 (브로슈어 2~3p)</a>
                            <a href="http://icm.re.kr/New_E-Book/PSJ_NEW/" target="_blank" class="btn-action justify-center">연구소 브로슈어 (E-BOOK)</a>
                        </div>
                    </div>
                    <div class="guide-card mb-0 flex flex-col">
                        <h4 class="font-bold text-white text-lg mb-2 flex items-center gap-2"><i class="fas fa-desktop text-amber-500"></i> 전문위원 홈페이지 가이드</h4>
                        <p class="text-sm text-slate-400 mb-4 flex-grow">나만의 브랜드 경쟁력을 강화하세요. 활용 방법과 샘플을 확인하실 수 있습니다.</p>
                        <div class="flex flex-col gap-2 mt-auto">
                            <a href="http://www.icm.re.kr/id/icm1000" target="_blank" class="btn-action justify-center">샘플 둘러보기</a>
                            <a href="https://youtu.be/b3pPujI6YZU" target="_blank" class="btn-action justify-center"><i class="fab fa-youtube text-red-500"></i> 활용안내 영상</a>
                        </div>
                    </div>
                </div>

                <!-- 전문콘텐츠 -->
<div class="guide-card mb-6">
                    <h4 class="font-bold text-white text-lg mb-4 flex items-center gap-2">
                        <i class="fas fa-layer-group text-amber-500"></i> 전문 콘텐츠 서비스
                    </h4>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-5">
                        <div class="bg-slate-950/50 rounded-xl p-5 border border-slate-700/50 flex flex-col">
                            <div class="mb-3">
                                <h5 class="font-bold text-white text-base flex items-center gap-2 mb-1">
                                    <i class="fas fa-newspaper text-blue-400"></i> 이슈브리핑 <span class="text-[10px] text-slate-500 font-normal border border-slate-700 px-1.5 rounded">Sample</span>
                                </h5>
                                <p class="text-xs text-slate-400 mb-1">매주 <strong>월요일, 금요일 오전 8시</strong> 제공</p>
                                <p class="text-[12px] text-slate-400 leading-relaxed">
                                    최신 제도 변화·시장 흐름을 다양한 콘텐츠 포맷으로 확인하실 수 있습니다.
                                </p>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-2 mt-auto">
                                <a href="https://youtu.be/kNtpNQRt_f8" target="_blank" class="btn-action justify-center py-2 text-xs">전문가영상</a>
                                <a href="https://drive.google.com/file/d/1QJOgPmXTCb7330Xa4kd8Np-OvxCl5UpS/view?usp=sharing" target="_blank" class="btn-action justify-center py-2 text-xs">팟캐스트</a>
                                <a href="https://issuebriefing-sample.netlify.app/" target="_blank" class="btn-action justify-center py-2 text-xs">브리핑문서</a>
                                <a href="https://drive.google.com/file/d/1xauDQupwmbTKgNlYAgkV8m63XpomkdXS/view?usp=sharing" target="_blank" class="btn-action justify-center py-2 text-xs">마인드맵</a>
                            </div>
                        </div>

                        <div class="bg-slate-950/50 rounded-xl p-5 border border-slate-700/50 flex flex-col">
                            <div class="mb-3">
                                <h5 class="font-bold text-white text-base flex items-center gap-2 mb-1">
                                    <i class="fas fa-file-signature text-purple-400"></i> 특급보고서 <span class="text-[10px] text-slate-500 font-normal border border-slate-700 px-1.5 rounded">Sample</span>
                                </h5>
                                <p class="text-xs text-slate-400 mb-1">매주 <strong>수요일 오후 6시</strong> 제공</p>
                                <p class="text-[12px] text-slate-400 leading-relaxed">
                                    가상의 컨설팅 사례를 통해 솔루션에 대한 실전 인사이트를 얻어가실 수 있습니다.
                                </p>
                            </div>
                            
                            <div class="mt-auto">
                                <a href="https://corporate-report-251125.netlify.app/" target="_blank" class="w-full btn-action justify-center py-2 text-xs bg-slate-800 hover:bg-purple-900/40 hover:text-purple-100 hover:border-purple-500/50 transition-all">
                                    <i class="fas fa-external-link-alt mr-1"></i> 보고서 샘플 확인
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="bg-amber-950/20 border border-amber-900/30 rounded-lg p-3 flex flex-col sm:flex-row items-center justify-between gap-3">
                        <div class="text-center sm:text-left">
                            <p class="text-xs text-amber-500 font-bold mb-0.5"><i class="fas fa-info-circle mr-1"></i> 전체 자료 확인하기</p>
                            <p class="text-[13px] text-slate-400">위 내용은 샘플이며, <strong class="text-slate-200">나만의 자료실</strong>에서 전체 자료를 확인하실 수 있습니다.</p>
                        </div>
                        <button onclick="showArchive()" class="shrink-0 bg-amber-600 hover:bg-amber-500 text-white text-xs font-bold px-4 py-2 rounded-lg shadow-md transition-colors flex items-center gap-2">
                            <i class="fas fa-folder-open"></i> 자료실 이동
                        </button>
                    </div>
                </div>
                
                <!-- 좌담회 및 성공사례 (내용 추가 완료) -->
                <div class="guide-card">
                    <h4 class="font-bold text-white text-lg mb-3"><i class="fas fa-users text-amber-500 mr-2"></i> 월 제공 세션 안내</h4>
                    <ul class="space-y-3 text-sm text-slate-300">
                        <li class="flex items-start gap-2"><i class="fas fa-check text-amber-500 mt-1"></i> <span><strong>전문가 좌담회:</strong> 적시성 있는 주제를 선정하여 온/오프라인 진행 (전월 25일 공지)</span></li>
                        <li class="flex items-start gap-2"><i class="fas fa-check text-amber-500 mt-1"></i> <span><strong>성공사례 공유:</strong> 회원간 우수 영업/계약 사례 공유 (Zoom 진행)</span></li>
                        <li class="flex items-start gap-2"><i class="fas fa-check text-amber-500 mt-1"></i> <span><strong>이너서클 활용안내 세션:</strong> 매월 온/오프라인 진행 </span></li>
                    </ul>
                </div>
            </section>

            <!-- [Section 3] 경쟁력 (Competitiveness) -->
            <section>
                <h3 class="section-title">비즈니스 경쟁력 <span class="text-sm text-slate-500 font-normal ml-2">Business Competitiveness</span></h3>
                
<div class="special-card mb-8 bg-gradient-to-r from-indigo-950 to-slate-900 p-8 rounded-3xl shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-red-600 text-white text-[10px] font-bold px-4 py-1.5 rounded-bl-xl shadow-md z-10">얼리버드 혜택</div>
                    
                    <div class="relative z-10 flex flex-col md:flex-row items-center justify-between gap-6">
                        <div class="text-center md:text-left flex-1">
<h4 class="font-bold text-white text-lg md:text-2xl mb-2 flex items-center justify-center md:justify-start gap-2">
    <i class="fas fa-rocket text-amber-400"></i> 기업 홈페이지 시스템 런칭
</h4>
                            <p class="text-indigo-300 text-base mb-3 font-bold">"비즈니스 올인원 플랫폼"</p>
                            
                            <p class="text-slate-400 text-sm leading-relaxed mb-5">
                                기업소개, 상품홍보, 고객소통, AI상담 기능까지 한곳에 담았습니다. 기존보다 더 직관적인 UI/UX와 업종별 맞춤 커스터마이징을 제공하여 기업 컨설팅 영업에 강력한 무기가 됩니다.
                            </p>

                            <div class="bg-indigo-900/40 border border-indigo-500/30 rounded-xl p-3.5 flex items-start gap-3 text-left shadow-inner backdrop-blur-sm">
                                <div class="mt-0.5 shrink-0">
                                    <i class="fas fa-user-cog text-amber-400 text-base"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-indigo-100 font-bold mb-1">이너서클 회원전용 관리자 페이지 제공</p>
                                    <p class="text-[11px] text-slate-400 leading-snug">
                                        회원님이 추천하여 기업 홈페이지를 등록한 <strong class="text-slate-300">기업현황을 직접 확인 및 관리</strong>할 수 있습니다.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-3 min-w-[280px] shrink-0">
                            <a href="https://cor-hompage.netlify.app/" target="_blank" class="bg-white text-indigo-900 py-3.5 px-6 rounded-xl font-bold hover:bg-indigo-50 transition-colors text-sm text-center shadow-sm flex items-center justify-center gap-2">
                                <span>안내문 보기</span> <i class="fas fa-chevron-right text-xs"></i>
                            </a>
                            <a href="https://pt-corp-homepage.netlify.app/" target="_blank" class="bg-amber-500 text-indigo-900 py-3.5 px-6 rounded-xl font-bold hover:bg-amber-400 transition-colors text-sm text-center shadow-sm flex items-center justify-center gap-2">
                                <span>제안서 보기</span> <i class="fas fa-file-powerpoint text-xs"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- 삼일회계법인 -->
<div class="guide-card mb-0 flex flex-col">
    <h4 class="font-bold text-white text-lg mb-2">삼일회계법인 M&A</h4>
    <p class="text-sm text-slate-400 mb-2 leading-relaxed">
        국내 최고 회계법인과 함께하는 M&A 컨설팅 지원.
    </p>
    <p class="text-xs text-slate-400 mb-4 leading-relaxed">
        매월 삼일회계법인 본사에서 진행되는 M&A세션에 참석하실 수 있으며,
        유가망기업 발생 시 검토의뢰서를 작성하여 박신제 본부장에게 전달해 주시면
        삼일회계법인으로부터 3~4일 내 피드백을 받으실 수 있습니다.
    </p>

    <!-- 버튼 영역: 나이스 카드와 동일한 구조 -->
    <div class="flex flex-col gap-2 mt-auto">
        <button 
            onclick="window.open('https://www.pwc.com/kr/ko/services/venture-mna.html', '_blank')" 
            class="w-full btn-action justify-center">
            M&A지원센터 바로가기
        </button>
        <button 
            onclick="window.open('https://drive.google.com/drive/folders/1Dst7J2eLawU3RtoHcK1DxuxVQg7wJds1?usp=sharing', '_blank')" 
            class="w-full btn-action justify-center">
            M&A 검토의뢰서 양식
        </button>
    </div>
</div>
                    <!-- 나이스평가정보 -->
                    <div class="guide-card mb-0 flex flex-col">
                        <h4 class="font-bold text-white text-lg mb-2">나이스평가정보(주)</h4>
                        <p class="text-sm text-slate-400 mb-4 flex-grow leading-relaxed">13년간 제휴를 통해 기업신용평가 및 기술평가 서비스를 지원해 드립니다.</p>
                        <div class="flex flex-col gap-2 mt-auto">
                            <button onclick="window.open('https://drive.google.com/file/d/1Q3vl81C6Z8Brc9aFh_EoHCqTyByfhAT6/view?usp=sharing', '_blank')" class="btn-action justify-center">기업신용평가서비스</button>
                            <button onclick="window.open('https://drive.google.com/file/d/1IlDvL01SIsfMsbtdcbm2AGWbTrQ66gDT/view?usp=drive_link', '_blank')" class="btn-action justify-center">기업신용평가등급 관리전략</button>
                        </div>
                    </div>
                    <!-- (주)로뎀 -->
                    <div class="guide-card mb-0 flex flex-col">
                        <h4 class="font-bold text-white text-lg mb-2">도시계획법인 (주)로뎀</h4>
                        <p class="text-sm text-slate-400 mb-4 flex-grow leading-relaxed">부동산 부문 최고위 전문가 집단으로부터 부동산 진단 분석 및 가치평가 서비스를 지원받습니다.</p>
                        <div class="flex flex-col gap-2 mt-auto">
                            <a href="http://www.rodem-u.com/content/profit01.php" target="_blank" class="btn-action justify-center">수행실적 확인</a>
                            <button onclick="window.open('https://drive.google.com/drive/folders/1yCj9QtKPbF4Gm29pbM8md6eNd5n2ArUn?usp=sharing', '_blank')" class="btn-action justify-center">진단분석 보고서</button>
                        </div>
                    </div>
                </div>
            </section>

<section>
                <h3 class="section-title">퍼스널 브랜딩 <span class="text-sm text-slate-500 font-normal ml-2">Personal Branding</span></h3>

                <div class="special-card mb-8 bg-gradient-to-r from-teal-950 to-slate-900 p-8 rounded-3xl shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-amber-500 text-slate-900 text-[10px] font-bold px-4 py-1.5 rounded-bl-xl shadow-md z-10">전문가 전용</div>
                    
                    <div class="relative z-10 flex flex-col md:flex-row items-center justify-between gap-8">
                        <div class="text-center md:text-left flex-1">
<h4 class="font-bold text-white text-lg md:text-2xl mb-2 flex items-center justify-center md:justify-start gap-2">
    <i class="fas fa-id-card-alt text-teal-400"></i> 컨설턴트 홈페이지 시스템 런칭
</h4>
                            <p class="text-teal-200 text-base mb-4 font-bold">"나만의 퍼스널 브랜딩을 시작하세요"</p>
                            
                            <p class="text-slate-400 text-sm leading-relaxed mb-6">
                                명함 한 장으로 신뢰 얻기 어려운 시대, 전문가 브랜딩이 필수입니다.<br class="hidden sm:block">
                                단순 홍보를 넘어, <strong class="text-white">AI 기술이 탑재된 나만의 플랫폼</strong>을 소유하세요.
                            </p>

                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-left">
                                <div class="bg-teal-900/30 border border-teal-500/30 rounded-lg p-3 flex items-start gap-3">
                                    <i class="fas fa-mobile-alt text-teal-400 mt-1"></i>
                                    <div class="text-xs text-slate-300">
                                        <strong class="block text-white mb-0.5">완벽한 호환성</strong>
                                        PC/모바일 최적화 반응형 디자인
                                    </div>
                                </div>
                                <div class="bg-teal-900/30 border border-teal-500/30 rounded-lg p-3 flex items-start gap-3">
                                    <i class="fas fa-headset text-teal-400 mt-1"></i>
                                    <div class="text-xs text-slate-300">
                                        <strong class="block text-white mb-0.5">24시간 AI 응대</strong>
                                        놓치는 고객 없는 자동 상담 시스템
                                    </div>
                                </div>
                                <div class="bg-teal-900/30 border border-teal-500/30 rounded-lg p-3 flex items-start gap-3">
                                    <i class="fas fa-file-invoice-dollar text-teal-400 mt-1"></i>
                                    <div class="text-xs text-slate-300">
                                        <strong class="block text-white mb-0.5">생성형 AI 보고서</strong>
                                        상담 요약 및 기업 재무보고서 자동 작성
                                    </div>
                                </div>
                                <div class="bg-teal-900/30 border border-teal-500/30 rounded-lg p-3 flex items-start gap-3">
                                    <i class="fas fa-share-alt text-teal-400 mt-1"></i>
                                    <div class="text-xs text-slate-300">
                                        <strong class="block text-white mb-0.5">미러사이트 기능</strong>
                                        본사 콘텐츠를 내 홈페이지로 손쉽게 공유
                                    </div>
                                </div>
                            </div>
                        </div>

<div class="flex flex-col sm:flex-row gap-3 min-w-[280px] shrink-0">
                            <a href="https://cn-homepage.netlify.app/" target="_blank" class="bg-white text-teal-900 py-3.5 px-6 rounded-xl font-bold hover:bg-teal-50 transition-colors text-sm text-center shadow-sm flex items-center justify-center gap-2">
                                <span>안내문 보기</span> <i class="fas fa-chevron-right text-xs"></i>
                            </a>
                            <a href="https://consultant.re.kr/" target="_blank" class="bg-teal-600 text-white py-3.5 px-6 rounded-xl font-bold hover:bg-teal-500 transition-colors text-sm text-center shadow-sm flex items-center justify-center gap-2">
                                <span>미러사이트</span> <i class="fas fa-globe text-xs"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                    
                    <div class="guide-card mb-0 flex flex-col">
                        <div class="mb-4">
                            <h4 class="text-lg font-bold text-white mb-1 flex items-center gap-2">
                                <i class="fas fa-search text-green-500"></i> 네이버 인물정보 등록
                            </h4>
                            <p class="text-sm text-slate-400">'경영컨설팅 전문위원' 등재 (제출서류: 당사 연구소인정서, 위촉장)</p>
                        </div>
                        
                        <div class="mt-auto space-y-3">
                            <div class="bg-slate-800/50 border border-slate-700/50 rounded-lg p-3">
                                <p class="text-[12px] text-slate-400 leading-snug">
                                    <i class="fas fa-comment-dots text-amber-500 mr-1"></i>
                                    채널톡 채팅창에 <strong class="text-white">"네이버 인물정보 등록 자료 요청합니다"</strong> 입력 후 전송해주세요.
                                </p>
                            </div>
                            <div class="flex gap-2">
                                <a href="https://search.naver.com/search.naver?where=nexearch&sm=tab_etc&mra=bjky&x_csa=%7B%22fromUi%22%3A%22kb%22%7D&pkid=1&os=33761309&qvt=0&query=%EC%9D%B4%EA%B4%91%ED%98%B8" target="_blank" class="btn-action flex-1 justify-center">샘플 보기</a>
                                <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="btn-gold flex-1 justify-center rounded-lg text-sm font-bold py-2 flex items-center">신청하기</a>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card mb-0 flex flex-col">
                        <div class="mb-4">
                            <h4 class="text-lg font-bold text-white mb-1 flex items-center gap-2">
                                <i class="far fa-id-badge text-amber-500"></i> 이너서클 전문위원 명함
                            </h4>
                            <p class="text-sm text-slate-400">당사 부설연구소 전문위원 명함을 사용하실 수 있습니다.</p>
                            <p class="text-xs text-amber-600 mt-1">※ 200장 35,000원, 택배비 포함 / 송금은 명함회사로 부탁드립니다.</p>
                        </div>

                        <div class="mt-auto space-y-3">
                            <div class="bg-slate-800/50 border border-slate-700/50 rounded-lg p-3">
                                <p class="text-[12px] text-slate-400 leading-snug">
                                    <i class="fas fa-comment-dots text-amber-500 mr-1"></i>
                                    채널톡 채팅창에 <strong class="text-white">"이너서클 전문위원 명함 신청합니다"</strong> 입력 후 전송해주세요.
                                </p>
                            </div>
                            <div class="flex gap-2">
                                <a href="https://drive.google.com/file/d/1WlmYg2g8WIPWAr25zQ8n6QfXefGyaQZs/view?usp=sharing" target="_blank" class="btn-action flex-1 justify-center">명함 샘플</a>
                                <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="btn-gold flex-1 justify-center rounded-lg text-sm font-bold py-2 flex items-center">신청하기</a>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card mb-0 flex flex-col">
                        <div class="mb-4">
                            <h4 class="text-lg font-bold text-white mb-1 flex items-center gap-2">
                                <i class="fas fa-book text-amber-500"></i> 브로슈어 (종이/E-북)
                            </h4>
                            <p class="text-sm text-slate-400">개인정보(성명, 직함, 프로필) 맞춤 디자인. 경영컨설팅, 자산관리 부문 연구소 전문위원 타이틀로 경쟁력과 전문성을 어필하실 수 있습니다.</p>
                            <p class="text-xs text-amber-600 mt-1">※ 이너서클 회원은 최소 200부 기준으로 신청 가능합니다. (회차별 제작인원수에 따라 120~150만원)</p>
                        </div>

                        <div class="mt-auto space-y-3">
                            <div class="bg-slate-800/50 border border-slate-700/50 rounded-lg p-3">
                                <p class="text-[12px] text-slate-400 leading-snug">
                                    <i class="fas fa-comment-dots text-amber-500 mr-1"></i>
                                    채널톡 채팅창에 <strong class="text-white">"브로슈어 제작 신청서 요청합니다"</strong> 입력 후 전송해주세요.
                                </p>
                            </div>
                            <div class="flex gap-2">
                                <a href="http://icm.re.kr/New_E-Book/PSJ_NEW/" target="_blank" class="btn-action flex-1 justify-center">샘플 보기</a>
                                <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="btn-gold flex-1 justify-center rounded-lg text-sm font-bold py-2 flex items-center">신청하기</a>
                            </div>
                        </div>
                    </div>

                    <div class="guide-card mb-0 flex flex-col">
                        <div class="mb-4">
                            <div class="flex justify-between items-start mb-2">
                                <h4 class="text-lg font-bold text-white flex items-center gap-2">
                                    <i class="fas fa-book-reader text-amber-500"></i> 아침독서 서비스
                                </h4>
                                <span class="bg-amber-600 text-white text-[10px] font-bold px-2 py-0.5 rounded shadow-sm">무료 제공</span>
                            </div>
                            <p class="text-sm text-slate-400">
                                매주 월요일 오전, 알림톡으로 도서 요약본(텍스트/음성)을 받아보세요. 고객에게 전달하기 좋은 맞춤형 웹페이지 형태로 제공됩니다.
                                <p class="text-xs text-amber-600 mt-1">※ 연간 310권 요약본 제공, 연간 30만원 상당, <strong>(주)북집 제휴</strong></span>
                            </p>
                        </div>

                        <div class="mt-auto space-y-3">
                            <div class="bg-slate-800/50 border border-slate-700/50 rounded-lg p-3">
                                <p class="text-[12px] text-slate-400 leading-snug">
                                    <i class="fas fa-comment-dots text-amber-500 mr-1"></i>
                                    채널톡 채팅창에 <strong class="text-white">"아침독서 제작 요청합니다"</strong> 입력 후 전송해주세요.
                                </p>
                            </div>
                            <div class="flex gap-2">
                                <a href="http://www.bookzip.kr/00.asp?c=297&b=583" target="_blank" class="btn-action flex-1 justify-center">샘플 보기</a>
                                <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="btn-gold flex-1 justify-center rounded-lg text-sm font-bold py-2 flex items-center">신청하기</a>
                            </div>
                        </div>
                    </div>

                </div>
            </section>


            <!-- [Section 6] 서비스 활용 가이드 영상 -->
            <section>
                <h3 class="section-title">서비스 활용 가이드 <span class="text-sm text-slate-500 font-normal ml-2">Video Guide</span></h3>
                <div class="guide-card p-8">
                    <div class="space-y-8">
                        <div>
                            <h5 class="text-sm font-bold text-amber-500 uppercase mb-3 border-b border-slate-700 pb-2">General (일반)</h5>
                            <div class="grid grid-cols-2 md:grid-cols-6 gap-3">
                                <a href="https://youtu.be/Wkwuv_-R-yU" target="_blank" class="btn-action text-xs justify-center">프로필 수정</a>
                                <a href="https://youtu.be/gO3Xsmb4rN4" target="_blank" class="btn-action text-xs justify-center">세미나 확인</a>
                                <a href="https://youtu.be/-mTWS4woV4s" target="_blank" class="btn-action text-xs justify-center">홈페이지 리뉴얼</a>
                                <a href="https://youtu.be/8_sz6H7NP9E" target="_blank" class="btn-action text-xs justify-center">연구소명함 신청</a>
                                <a href="https://youtu.be/0_MZJk3O1Pc" target="_blank" class="btn-action text-xs justify-center">아침독서 신청</a>
                                <a href="https://youtu.be/02ATQRLeCAs" target="_blank" class="btn-action text-xs justify-center">이너서클 채널</a>
                            </div>
                        </div>
                        <div>
                            <h5 class="text-sm font-bold text-amber-500 uppercase mb-3 border-b border-slate-700 pb-2">Branding/Management (브랜딩/고객 관리)</h5>
                            <div class="grid grid-cols-2 md:grid-cols-6 gap-3">
                                <a href="https://youtu.be/Evqew1ZVy20" target="_blank" class="btn-action text-xs justify-center">전문위원 명함</a>
                                <a href="https://youtu.be/ek1saB7E3mI" target="_blank" class="btn-action text-xs justify-center">가이드북 활용</a>
                                <a href="https://youtu.be/iCKnH6uLGEM" target="_blank" class="btn-action text-xs justify-center">모바일 명함</a>
                                <a href="https://youtu.be/meDNlr0F78o" target="_blank" class="btn-action text-xs justify-center">아침독서 활용</a>
                            </div>
                        </div>

                        <div>
                            <h5 class="text-sm font-bold text-amber-500 uppercase mb-3 border-b border-slate-700 pb-2">Capacity building (역량 강화)</h5>
                            <div class="grid grid-cols-2 md:grid-cols-6 gap-3">
                                <a href="https://youtu.be/jAeKp_sTPlU" target="_blank" class="btn-action text-xs justify-center">이슈 브리핑</a>
                                <a href="https://youtu.be/ZU694dPmawA" target="_blank" class="btn-action text-xs justify-center">FP센터 홈피</a>
                                <a href="https://youtu.be/oEQX2J_2kDU" target="_blank" class="btn-action text-xs justify-center">체크리스트</a>
                                <a href="https://youtu.be/sKMZmUDgnPA" target="_blank" class="btn-action text-xs justify-center">성공사례 공유</a>
                            </div>
                        </div>

                        <div>
                            <h5 class="text-sm font-bold text-amber-500 uppercase mb-3 border-b border-slate-700 pb-2">Capacity building (역량 강화)</h5>
                            <div class="grid grid-cols-2 md:grid-cols-6 gap-3">
                                <a href="https://youtu.be/jAeKp_sTPlU" target="_blank" class="btn-action text-xs justify-center">이슈 브리핑</a>
                                <a href="https://youtu.be/ZU694dPmawA" target="_blank" class="btn-action text-xs justify-center">FP센터 홈페이지</a>
                                <a href="https://youtu.be/oEQX2J_2kDU" target="_blank" class="btn-action text-xs justify-center">체크리스트</a>
                                <a href="https://youtu.be/sKMZmUDgnPA" target="_blank" class="btn-action text-xs justify-center">성공사례 공유</a>
                            </div>
                        </div>

                        <div>
                            <h5 class="text-sm font-bold text-amber-500 uppercase mb-3 border-b border-slate-700 pb-2">Discovery (고객 발굴)</h5>
                            <div class="grid grid-cols-2 md:grid-cols-6 gap-3">
                                <a href="https://youtu.be/KfbZaCklueg" target="_blank" class="btn-action text-xs justify-center">부동산 자산가</a>
                                <a href="https://youtu.be/eaihvLCwxqw" target="_blank" class="btn-action text-xs justify-center">입찰/공공시장</a>
                                <a href="https://youtu.be/x9OqThl2Rps" target="_blank" class="btn-action text-xs justify-center">연구소 보유기업</a>
                            </div>
                        </div>

                    </div>
                </div>
            </section>

            <!-- [Section 7] 기타 및 문의 -->
            <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                <div class="guide-card p-8 flex flex-col justify-center items-center text-center mb-0">
                    <p class="text-slate-300 text-base mb-6 leading-relaxed">
                        이너서클 멤버십 서비스에 대해<br>문의가 있으신 경우<br>
                        <strong class="text-white text-xl">아래 버튼으로 카카오톡 문의 남겨주세요.</strong>
                    </p>
                    <a href="http://pf.kakao.com/_exmxaWb" target="_blank" class="w-full btn-gold py-4 rounded-xl font-bold text-base text-center transition-colors shadow-lg flex items-center justify-center">
                        <i class="fas fa-comment-dots mr-2"></i> 카카오톡 문의하기
                    </a>
                </div>
                
                <div class="guide-card p-8 flex items-center justify-between mb-0">
                    <div>
                        <p class="text-amber-500 font-bold text-xs mb-2 uppercase tracking-wider">Membership Inquiry</p>
                        <p class="text-white font-bold text-2xl">박신제 본부장</p>
                    </div>
                    <a href="tel:010-5244-1467" class="text-3xl font-black text-white hover:text-amber-400 transition-colors flex items-center">
                        <span class="text-xl mr-3 hidden sm:inline font-medium text-slate-400">010-5244-1467</span> <i class="fas fa-phone-square-alt"></i> 
                    </a>
                </div>
            </section>

        </main>

        <footer class="text-center py-10 border-t border-slate-800 mt-10">
            <p class="text-slate-500 text-xs">Copyright © 2025 (주)한국FP센터. All Rights Reserved.</p>
        </footer>
    </div>

    <!-- 3. 자료실 화면 (Dark Theme) -->
    <div id="archive-section" class="hidden min-h-screen bg-slate-900 pb-20">
        <header class="glass-header sticky top-0 z-50 bg-slate-900/90 border-slate-800">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex justify-between items-center">
                <h1 class="text-xl font-bold text-white flex items-center gap-2">
                    <i class="fas fa-folder-open text-amber-500"></i> 나만의 자료실
                </h1>
                <button onclick="closeArchive()" class="text-sm font-bold text-slate-300 bg-slate-800 border border-slate-600 px-5 py-2.5 rounded-full hover:bg-slate-700 transition-colors shadow-sm flex items-center gap-2">
                    <i class="fas fa-arrow-left"></i> 메인으로
                </button>
            </div>
        </header>

        <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl sm:text-3xl font-black text-white mb-2"><span id="archive-user-name" class="text-amber-400"></span>님의 전용 라이브러리</h2>
                <p class="text-slate-400 text-sm">회원 유형(<span id="archive-user-type" class="font-bold text-white"></span>)에 맞는 자료가 자동으로 제공됩니다.</p>
            </div>

            <!-- 컨트롤 패널 -->
            <div class="bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-700 mb-6 sticky top-24 z-40">
                <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
                    <div class="flex flex-wrap gap-2 w-full md:w-auto justify-center" id="category-filters">
                        <button onclick="filterArchive('all')" class="filter-btn active px-4 py-2 rounded-full border border-slate-600 text-sm font-bold text-slate-400 hover:bg-slate-700 transition-all" data-filter="all">전체</button>
                        <button onclick="filterArchive('특급보고서')" class="filter-btn px-4 py-2 rounded-full border border-slate-600 text-sm font-bold text-purple-400 hover:bg-slate-700 transition-all" data-filter="특급보고서">특급보고서</button>
                        
                        <button onclick="filterArchive('이슈브리핑')" class="filter-btn px-4 py-2 rounded-full border border-slate-600 text-sm font-bold text-blue-400 hover:bg-slate-700 transition-all" data-filter="이슈브리핑">이슈브리핑</button>
                    </div>
                    <div class="flex gap-2 w-full md:w-auto">
                        <div class="relative flex-grow">
                            <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm"></i>
                            <input type="text" id="archive-search" onkeyup="searchArchive()" placeholder="주제, 내용 등 검색" class="w-full pl-9 pr-4 py-2.5 rounded-xl border border-slate-600 bg-slate-900 text-white focus:border-amber-500 outline-none text-sm font-medium placeholder-slate-600">
                        </div>
                        <div class="relative">
                            <select id="archive-sort" onchange="sortArchive()" class="appearance-none pl-4 pr-10 py-2.5 rounded-xl border border-slate-600 bg-slate-900 text-sm font-bold text-slate-400 outline-none focus:border-amber-500 cursor-pointer h-full">
                                <option value="newest">최신순</option>
                                <option value="oldest">오래된순</option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500">
                                <i class="fas fa-chevron-down text-xs"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="archive-list" class="space-y-4 min-h-[300px]"></div>

<div id="pagination" class="flex justify-center gap-2 mt-8 pb-10"></div>

        </main>
    </div>

<div id="pw-modal" class="hidden fixed inset-0 bg-slate-950/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
        <div class="bg-slate-900 border border-slate-700 rounded-2xl p-8 w-full max-w-sm shadow-2xl relative">
            <button id="pw-modal-close-btn" onclick="closePwModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
                <i class="fas fa-lock text-amber-500"></i> 비밀번호 변경
            </h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1">현재 비밀번호</label>
                    <input type="password" id="current-pw" class="w-full px-4 py-3 rounded-xl bg-slate-950 border border-slate-700 text-white focus:border-amber-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1">새로운 비밀번호</label>
                    <input type="password" id="new-pw" class="w-full px-4 py-3 rounded-xl bg-slate-950 border border-slate-700 text-white focus:border-amber-500 outline-none">
                </div>
                <button onclick="changePassword()" class="w-full btn-gold py-3 rounded-xl font-bold mt-2">변경하기</button>
            </div>
        </div>
    </div>

    <script>
        // [중요] 배포한 앱스 스크립트 URL 입력
        const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby3rFMVH7vzNwbyEqyQbYUp9MZvNSSl7sF_YN8lMAu6zmqSiffiq9o_Oqax6-CWUPdL/exec"; 

        let globalArchives = [];
        let currentUserInfo = null;
        let isFirstLogin = false;
        let loginIdForPwChange = "";

        // ========================================
        // 페이지 로드 시 세션 체크
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            const sessionData = sessionStorage.getItem('loggedInUser');
            
            if (!sessionData) {
                alert('로그인이 필요합니다.');
                window.location.href = '/';
                return;
            }
            
            try {
                const userData = JSON.parse(sessionData);
                
                // 이너서클 회원인지 확인
                if (userData.type !== '이너서클') {
                    alert('이너서클 회원만 접근 가능합니다.');
                    window.location.href = '/';
                    return;
                }
                
                // 사용자 정보 설정
                currentUserInfo = userData.userInfo;
                loginIdForPwChange = userData.name;
                
                // 대시보드 표시
                showDashboard();
                
            } catch (e) {
                console.error('세션 파싱 오류:', e);
                window.location.href = '/';
            }
        });

        function showDashboard() {
            window.scrollTo(0,0);

            const user = currentUserInfo;
            document.getElementById('user-name-display').innerText = user.name;

// [NEW] 지원사항 (Support) 표시 로직
const supportBox = document.getElementById('support-status-box');
            if (user.support && user.support.trim() !== "") {
                supportBox.classList.remove('hidden');
                document.getElementById('support-text').innerText = user.support;
            } else {
                supportBox.classList.add('hidden');
            }
            
            // [NEW] 공지사항 로드 (Notice 시트에서)
            loadNotices();

            // 전문위원 홈페이지 정보
            const icmId = user.icmId || "(미등록)";
            const icmPw = user.icmPw || "(미등록)";
            document.getElementById('icm-id-display').innerText = icmId;
            document.getElementById('icm-pw-display').innerText = icmPw;
            
            const btnLink = document.getElementById('btn-icm-link');
            if(user.icmId) {
                btnLink.href = `http://www.icm.re.kr/id/${user.icmId}`;
            } else {
                btnLink.removeAttribute('href');
                btnLink.onclick = (e) => { e.preventDefault(); alert("홈페이지 ID가 등록되지 않았습니다."); };
                btnLink.classList.add('opacity-50', 'cursor-not-allowed');
            }

            // [NEW] 특급보고서 로드
            loadSpecialReport();

            // [NEW] 이슈브리핑 로드
            loadIssueBriefing();
        }

        // 자료실 기능 (Dark Mode 적용)
        function showArchive() {
            document.getElementById('dashboard-section').classList.add('hidden');
            document.getElementById('archive-section').classList.remove('hidden');
            window.scrollTo(0, 0);

            document.getElementById('archive-user-name').innerText = currentUserInfo.name;
            document.getElementById('archive-user-type').innerText = currentUserInfo.type;

            // [수정] GitHub에서 자료 목록 가져오기
            loadGitHubArchives();
        }

        function closeArchive() {
            document.getElementById('archive-section').classList.add('hidden');
            document.getElementById('dashboard-section').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function renderArchiveList(data) {
            const container = document.getElementById('archive-list');
            container.innerHTML = "";

            if(data.length === 0) {
                container.innerHTML = '<div class="text-center py-20 text-slate-500"><i class="fas fa-box-open text-4xl mb-3"></i><p>조건에 맞는 자료가 없습니다.</p></div>';
                return;
            }

            const today = new Date();
            const sevenDaysAgo = new Date(today);
            sevenDaysAgo.setDate(today.getDate() - 7);

            data.forEach((item, index) => {
                let isNew = false;
                try {
                    const itemDate = new Date(item.date);
                    if(itemDate >= sevenDaysAgo) isNew = true;
                } catch(e){}

                let badgeColor = "bg-slate-700 text-slate-300";
                let icon = "fa-file-alt";
                if(item.category.includes("특급")) { badgeColor = "bg-purple-900/50 text-purple-300 border border-purple-700/50"; icon = "fa-star"; }
                else if(item.category.includes("이슈")) { badgeColor = "bg-blue-900/50 text-blue-300 border border-blue-700/50"; icon = "fa-newspaper"; }

                const hasDetails = (item.details && item.details.trim() !== "");
                const clickAttr = hasDetails ? `onclick="toggleDetails('details-${index}')"` : '';
                const cursorClass = hasDetails ? 'cursor-pointer' : 'cursor-default';
                


                const html = `
                    <div class="bg-slate-800 rounded-xl border border-slate-700 shadow-sm transition-all overflow-hidden fade-in" style="animation-delay: ${index * 0.05}s">
                        <div class="p-5 flex flex-col md:flex-row justify-between gap-4 ${cursorClass}" ${clickAttr}>
                            <div class="flex-grow">
                                <div class="flex flex-wrap gap-2 items-center mb-2">
                                    <span class="bg-slate-700 text-slate-400 px-2.5 py-0.5 rounded text-xs font-bold flex items-center gap-1">
                                        <i class="far fa-calendar-alt"></i> ${item.date}
                                    </span>
                                    <span class="${badgeColor} px-2.5 py-0.5 rounded text-xs font-bold flex items-center gap-1">
                                        <i class="fas ${icon}"></i> ${item.category}
                                    </span>
                                    ${isNew ? '<span class="bg-red-600 text-white text-[10px] font-bold px-1.5 rounded animate-pulse">NEW</span>' : ''}
                                </div>
                                <h3 class="text-lg font-bold text-white mb-1 ${hasDetails ? 'hover:text-amber-400 transition-colors' : ''}">${item.topic}</h3>
                                ${item.speaker ? `<p class="text-sm text-slate-400"><i class="fas fa-user-tie mr-1 opacity-50"></i> ${item.speaker}</p>` : ''}
                            </div>

                            <div class="flex items-center gap-2 self-start md:self-center shrink-0 flex-wrap">
                                ${hasDetails ? `
                                <button onclick="event.stopPropagation(); toggleDetails('details-${index}')" class="px-3 py-2.5 bg-slate-700 border border-slate-600 text-slate-300 text-xs font-bold rounded-lg hover:bg-slate-600 transition-colors shadow-sm flex items-center whitespace-nowrap">
                                    상세내용 보기 <i class="fas fa-chevron-down ml-1"></i>
                                </button>` : ''}
                                
                                <button onclick="event.stopPropagation(); copyLink('${item.url}')" class="px-4 py-2.5 bg-slate-700 border border-slate-600 text-slate-300 text-xs font-bold rounded-lg hover:bg-slate-600 transition-colors whitespace-nowrap">
                                    <i class="fas fa-link mr-1"></i> 링크 복사
                                </button>

                                ${item.videoUrl && item.videoUrl.trim() !== "" ? `
                                <a href="${item.videoUrl}" target="_blank" onclick="event.stopPropagation()" class="px-4 py-2.5 bg-red-900/80 border border-red-700 text-red-100 text-xs font-bold rounded-lg hover:bg-red-800 transition-colors whitespace-nowrap flex items-center gap-1">
                                    <i class="fab fa-youtube"></i> 영상 보기
                                </a>
                                ` : ''}

                                <a href="${item.url}" target="_blank" onclick="event.stopPropagation()" class="px-5 py-2.5 btn-gold text-slate-900 text-xs font-bold rounded-lg shadow-sm flex items-center whitespace-nowrap">
                                    <i class="fas fa-external-link-alt mr-1"></i> 자료 보기
                                </a>
                            </div>
                        </div>
                        
                        ${hasDetails ? `<div id="details-${index}" class="hidden bg-slate-900/50 border-t border-slate-700 p-5"><div class="text-sm text-slate-300 leading-relaxed benefit-text bg-slate-800 p-4 rounded-lg border border-slate-700 shadow-inner">${item.details.trim()}</div></div>` : ''}
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function filterArchive(cat) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            const targetBtn = document.querySelector(`.filter-btn[data-filter="${cat}"]`);
            if(targetBtn) targetBtn.classList.add('active');

            const search = document.getElementById('archive-search').value.toLowerCase();
            const filtered = globalArchives.filter(item => {
                const matchCat = (cat === 'all') || (item.category.includes(cat));
                const matchSearch = (item.topic.toLowerCase().includes(search) || 
                                     item.speaker.toLowerCase().includes(search) || 
                                     (item.details && item.details.toLowerCase().includes(search)));
                return matchCat && matchSearch;
            });
            sortAndRender(filtered);
        }

        function searchArchive() {
            const activeBtn = document.querySelector('.filter-btn.active');
            const currentCat = activeBtn ? activeBtn.dataset.filter : 'all';
            filterArchive(currentCat);
        }

        function sortArchive() { searchArchive(); }

        function sortAndRender(data) {
            const sortMode = document.getElementById('archive-sort').value;
            const sorted = [...data].sort((a, b) => {
                const dateA = new Date(a.date);
                const dateB = new Date(b.date);
                return sortMode === 'newest' ? dateB - dateA : dateA - dateB;
            });
            renderArchiveList(sorted);
        }

function toggleDetails(id) {
    const el = document.getElementById(id);
    if(el.classList.contains('hidden')) {
        el.classList.remove('hidden');
        el.classList.add('fade-in'); // 열 때 애니메이션 추가
    } else {
        el.classList.add('hidden');
        el.classList.remove('fade-in'); // 닫을 때 클래스 제거 (다음에 다시 열 때 애니메이션이 작동하도록)
    }
}

        function copyLink(url) { navigator.clipboard.writeText(url).then(() => alert('링크가 복사되었습니다.')); }

// ----------------------
// 🔹 아카이브 페이지네이션 설정
// ----------------------

// 기존 renderArchiveList 백업 (원래 한 페이지 전체 그리는 함수)
const originalRenderArchiveList = renderArchiveList;

// 상태 변수
let archivePageSize = 10;          // 👉 페이지당 보여줄 개수 (원하면 10 등으로 조정)
let archiveCurrentPage = 1;
let archiveTotalPages = 1;
let archiveAllData = [];

// 기존 이름을 그대로 사용해서 "페이지네이션 래퍼"로 교체
renderArchiveList = function (data) {
    archiveAllData   = data || [];
    archiveTotalPages = Math.max(1, Math.ceil(archiveAllData.length / archivePageSize));
    archiveCurrentPage = 1;
    renderArchivePage();
};

// 실제로 현재 페이지의 데이터만 잘라서 그리고, 버튼까지 같이 그려주는 함수
function renderArchivePage() {
    const start = (archiveCurrentPage - 1) * archivePageSize;
    const end   = start + archivePageSize;
    const pageData = archiveAllData.slice(start, end);

    // 원래 있던 렌더링 함수로 "이 페이지에 해당하는 데이터만" 그림
    originalRenderArchiveList(pageData);

    renderPaginationButtons();
}

// 페이지네이션 버튼 렌더링
function renderPaginationButtons() {
    const pagEl = document.getElementById('pagination');
    if (!pagEl) return;

    pagEl.innerHTML = '';

    if (archiveTotalPages <= 1) return;  // 1페이지면 버튼 필요 없음

    // 공통 버튼 생성 함수
    const makeBtn = (label, page, options = {}) => {
        const btn = document.createElement('button');
        btn.textContent = label;

        const baseClass =
            'min-w-[36px] h-9 px-3 text-xs rounded-lg border font-bold transition-colors ' +
            'bg-white text-slate-500 border-slate-300 hover:bg-slate-100';

        const activeClass =
            ' bg-indigo-50 text-indigo-600 border-indigo-500';

        const disabledClass =
            ' opacity-40 cursor-not-allowed hover:bg-white';

        btn.className = baseClass +
            (options.active ? activeClass : '') +
            (options.disabled ? disabledClass : '');

        if (!options.disabled) {
            btn.onclick = () => {
                archiveCurrentPage = page;
                renderArchivePage();
            };
        }

        return btn;
    };

    // 이전 버튼
    pagEl.appendChild(
        makeBtn('이전', Math.max(1, archiveCurrentPage - 1), {
            disabled: archiveCurrentPage === 1
        })
    );

    // 페이지 번호 버튼 (1 ~ totalPages)
    for (let i = 1; i <= archiveTotalPages; i++) {
        pagEl.appendChild(
            makeBtn(String(i), i, {
                active: archiveCurrentPage === i
            })
        );
    }

    // 다음 버튼
    pagEl.appendChild(
        makeBtn('다음', Math.min(archiveTotalPages, archiveCurrentPage + 1), {
            disabled: archiveCurrentPage === archiveTotalPages
        })
    );
}

// [NEW] 비밀번호 변경 관련 함수
        function openPwModal() { 
            document.getElementById('pw-modal').classList.remove('hidden');
            // [수정] 최초 로그인이면 X 버튼 숨김
            const closeBtn = document.getElementById('pw-modal-close-btn');
            if (closeBtn) {
                closeBtn.style.display = isFirstLogin ? 'none' : 'block';
            }
        }
        function closePwModal() { 
            // [수정] 최초 로그인이면 닫기 불가
            if (isFirstLogin) {
                alert("보안을 위해 비밀번호를 먼저 변경해주세요.\n\n※ 비밀번호 변경 후 서비스 이용이 가능합니다.");
                return;
            }
            document.getElementById('pw-modal').classList.add('hidden'); 
            document.getElementById('current-pw').value = '';
            document.getElementById('new-pw').value = '';
        }

        async function changePassword() {
            const currentPw = document.getElementById('current-pw').value;
            const newPw = document.getElementById('new-pw').value;
            if(!currentPw || !newPw) return alert("모든 항목을 입력해주세요.");

            if(currentPw === newPw) return alert("새 비밀번호는 현재 비밀번호와 달라야 합니다.");

            if(!confirm("비밀번호를 변경하시겠습니까?")) return;

            // 로딩 표시 등 UX 추가 가능
            try {
                // 로그인 시 저장된 이름 사용 (개인이면 이름, 기업이면 ID가 넘어감. 
                // 단, 현재 로직상 기업은 ID, 개인은 이름으로 로그인하므로 
                // doPost에서 구분 로직을 잘 처리해두었습니다.)
                // **주의**: 개인회원 비밀번호 변경 시 '이름'을 기준으로 찾으므로 동명이인 이슈가 있을 수 있으나, 
                // 현재 로직상 ID/PW 둘다 맞아야 하므로 안전합니다.
                
                // 로그인시 사용했던 ID(inputName) 값을 저장해뒀다가 써야 정확합니다.
                // 편의상 현재 로그인된 이름(currentUserInfo.name)을 사용하겠습니다.
                // (만약 기업회원이라면 아이디가 필요한데, currentUserInfo.name은 한글명일 수 있음. 
                //  기업회원 로그인을 위해 처음에 입력했던 아이디를 저장해두는 전역변수가 필요합니다.)
                
                // **수정 제안**: handleLogin 함수에서 `loginName` 전역변수에 입력한 ID를 저장해두세요.
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'changePassword', 
                name: window.loginIdForPwChange, 
                currentPw: currentPw, 
                newPw: newPw,
                source: 'inner'
                    })
                });
                const data = await response.json();
                alert(data.message);
                if(data.success) {
                    // [수정] 최초 로그인이면 localStorage 설정 후 대시보드 표시
                    if (isFirstLogin) {
                        const storageKey = 'visited_' + currentUserInfo.id;
                        localStorage.setItem(storageKey, 'true');
                        isFirstLogin = false;
                        showDashboard();
                    }
                    closePwModal();
                }
            } catch(e) {
                alert("오류가 발생했습니다.");
            }
        }

// [NEW] 공지사항 토글 함수
        function toggleNotice() {
            const wrapper = document.getElementById('notice-content-wrapper');
            const gradient = document.getElementById('notice-gradient');
            const btn = document.getElementById('notice-toggle-btn');
            const isExpanded = wrapper.classList.contains('max-h-[3.6rem]'); // 현재 접혀있는지 확인

            if (isExpanded) {
                // 펼치기
                wrapper.classList.remove('max-h-[3.6rem]'); // 높이 제한 해제
                // wrapper.style.maxHeight = wrapper.scrollHeight + "px"; // 부드러운 애니메이션 원하면 이 방식 사용 (선택사항)
                gradient.classList.add('hidden'); // 그라데이션 숨김
                btn.innerHTML = '<span>접기</span> <i class="fas fa-chevron-up"></i>';
            } else {
                // 다시 접기
                wrapper.classList.add('max-h-[3.6rem]');
                gradient.classList.remove('hidden');
                btn.innerHTML = '<span>더 보기</span> <i class="fas fa-chevron-down"></i>';
            }
        }

// [NEW] 텍스트 내의 URL을 찾아서 링크 태그로 변환해주는 함수
        function linkify(text) {
            // URL 패턴 정규식 (http, https로 시작하는 주소 감지)
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            
            return text.replace(urlRegex, function(url) {
                // 링크 스타일: 앰버색(Gold), 밑줄, 새 창으로 열기, 긴 주소 줄바꿈(break-all)
                return `<a href="${url}" target="_blank" class="text-amber-400 hover:text-amber-200 underline decoration-amber-500/50 break-all transition-colors">${url}</a>`;
            });
        }

// [NEW] 특급보고서 GitHub에서 최신 파일 가져오기
async function loadSpecialReport() {
    const GITHUB_API_URL = 'https://api.github.com/repos/kfpc0808/innercircle/contents/special_report';
    const NETLIFY_BASE_URL = 'https://innermember.netlify.app/special_report/';
    
    try {
        const response = await fetch(GITHUB_API_URL);
        if (!response.ok) throw new Error('GitHub API 오류');
        
        const files = await response.json();
        
        // HTML 파일만 필터링하고 날짜순 정렬 (최신순)
        const htmlFiles = files
            .filter(f => f.name.endsWith('.html'))
            .sort((a, b) => b.name.localeCompare(a.name));
        
        if (htmlFiles.length === 0) {
            console.log('특급보고서 파일이 없습니다.');
            return;
        }
        
        // 최신 파일 가져오기
        const latestFile = htmlFiles[0];
        const fileName = latestFile.name;
        
        // 파일명에서 제목 추출: (20260107)CEO 자산보호를 위한 신탁전략.html → (20260107) CEO 자산보호를 위한 신탁전략
        const displayTitle = fileName.replace('.html', '');
        
        // URL 생성 (한글 인코딩)
        const fileUrl = NETLIFY_BASE_URL + encodeURIComponent(fileName);
        
        // UI 업데이트
        document.getElementById('special-report-title').textContent = displayTitle;
        document.getElementById('special-report-link').href = fileUrl;
        document.getElementById('special-report-btn').href = fileUrl;
        document.getElementById('special-report-box').classList.remove('hidden');
        
        console.log('특급보고서 로드 완료:', displayTitle);
        
    } catch (error) {
        console.error('특급보고서 로드 실패:', error);
        // 실패해도 다른 기능에 영향 없음
    }
}

// [NEW] 이슈브리핑 GitHub에서 최신 파일 가져오기
async function loadIssueBriefing() {
    const GITHUB_API_URL = 'https://api.github.com/repos/kfpc0808/innercircle/contents/issue_briefing';
    const NETLIFY_BASE_URL = 'https://innermember.netlify.app/issue_briefing/';
    
    try {
        const response = await fetch(GITHUB_API_URL);
        if (!response.ok) throw new Error('GitHub API 오류');
        
        const files = await response.json();
        
        // HTML 파일만 필터링하고 날짜순 정렬 (최신순)
        const htmlFiles = files
            .filter(f => f.name.endsWith('.html'))
            .sort((a, b) => b.name.localeCompare(a.name));
        
        if (htmlFiles.length === 0) {
            console.log('이슈브리핑 파일이 없습니다.');
            return;
        }
        
        // 최신 파일 가져오기
        const latestFile = htmlFiles[0];
        const fileName = latestFile.name;
        
        // 파일명에서 제목 추출
        const displayTitle = fileName.replace('.html', '');
        
        // URL 생성 (한글 인코딩)
        const fileUrl = NETLIFY_BASE_URL + encodeURIComponent(fileName);
        
        // UI 업데이트
        document.getElementById('issue-briefing-title').textContent = displayTitle;
        document.getElementById('issue-briefing-link').href = fileUrl;
        document.getElementById('issue-briefing-btn').href = fileUrl;
        document.getElementById('issue-briefing-box').classList.remove('hidden');
        
        console.log('이슈브리핑 로드 완료:', displayTitle);
        
    } catch (error) {
        console.error('이슈브리핑 로드 실패:', error);
        // 실패해도 다른 기능에 영향 없음
    }
}

// [NEW] GitHub에서 자료실 데이터 가져오기
async function loadGitHubArchives() {
    const GITHUB_API_BASE = 'https://api.github.com/repos/kfpc0808/innercircle/contents/';
    const NETLIFY_BASE = 'https://innermember.netlify.app/';
    
    // 로딩 표시
    const container = document.getElementById('archive-list');
    container.innerHTML = '<div class="text-center py-20 text-slate-400"><i class="fas fa-circle-notch fa-spin text-4xl mb-3"></i><p>자료를 불러오는 중...</p></div>';
    
    try {
        // 두 폴더에서 파일 목록 가져오기
        const [specialRes, issueRes] = await Promise.all([
            fetch(GITHUB_API_BASE + 'special_report'),
            fetch(GITHUB_API_BASE + 'issue_briefing')
        ]);
        
        const specialFiles = specialRes.ok ? await specialRes.json() : [];
        const issueFiles = issueRes.ok ? await issueRes.json() : [];
        
        // 파일 데이터를 자료실 형식으로 변환
        const archives = [];
        
        // 특급보고서 처리
        specialFiles.filter(f => f.name.endsWith('.html')).forEach(file => {
            const parsed = parseFileName(file.name);
            archives.push({
                date: parsed.date,
                category: '컨설팅특급보고서',
                topic: parsed.title,
                speaker: '',
                details: '',
                url: NETLIFY_BASE + 'special_report/' + encodeURIComponent(file.name),
                videoUrl: ''
            });
        });
        
        // 이슈브리핑 처리
        issueFiles.filter(f => f.name.endsWith('.html')).forEach(file => {
            const parsed = parseFileName(file.name);
            archives.push({
                date: parsed.date,
                category: '이슈브리핑',
                topic: parsed.title,
                speaker: '',
                details: '',
                url: NETLIFY_BASE + 'issue_briefing/' + encodeURIComponent(file.name),
                videoUrl: ''
            });
        });
        
        // 날짜순 정렬 (최신순)
        archives.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        // globalArchives 업데이트 (필터/검색용)
        globalArchives = archives;
        
        // 렌더링
        renderArchiveList(globalArchives);
        
        console.log('GitHub 자료실 로드 완료:', archives.length + '개');
        
    } catch (error) {
        console.error('GitHub 자료실 로드 실패:', error);
        container.innerHTML = '<div class="text-center py-20 text-red-400"><i class="fas fa-exclamation-triangle text-4xl mb-3"></i><p>자료를 불러오는데 실패했습니다.</p></div>';
    }
}

// 파일명에서 날짜와 제목 추출
// (20260107)CEO 자산보호를 위한 신탁전략.html → { date: '2026-01-07', title: 'CEO 자산보호를 위한 신탁전략' }
function parseFileName(fileName) {
    const nameWithoutExt = fileName.replace('.html', '');
    const match = nameWithoutExt.match(/^\((\d{4})(\d{2})(\d{2})\)(.+)$/);
    
    if (match) {
        return {
            date: `${match[1]}-${match[2]}-${match[3]}`,
            title: match[4].trim()
        };
    }
    
    // 형식이 안 맞으면 그대로 반환
    return {
        date: new Date().toISOString().slice(0, 10),
        title: nameWithoutExt
    };
}

// =============================================
// [NEW] 공지사항 관련 함수들
// =============================================
let allNotices = []; // 전체 공지사항 저장

// 공지사항 로드
async function loadNotices() {
    try {
        const response = await fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ 
                action: 'getNotices', 
                target: '이너서클'
            })
        });
        
        const data = await response.json();
        
        if (data.success && data.notices && data.notices.length > 0) {
            allNotices = data.notices;
            
            // 최신 공지사항 표시
            const latest = allNotices[0];
            showLatestNotice(latest);
        } else {
            // 공지사항이 없으면 박스 숨김
            document.getElementById('inner-notice-box').classList.add('hidden');
        }
    } catch (error) {
        console.error('공지사항 로드 실패:', error);
        document.getElementById('inner-notice-box').classList.add('hidden');
    }
}

// 최신 공지사항 표시
function showLatestNotice(notice) {
    const noticeBox = document.getElementById('inner-notice-box');
    const yearMonthEl = document.getElementById('notice-yearmonth');
    const titleEl = document.getElementById('notice-title');
    const textEl = document.getElementById('notice-text');
    const wrapper = document.getElementById('notice-content-wrapper');
    const gradient = document.getElementById('notice-gradient');
    const toggleBtn = document.getElementById('notice-toggle-btn');
    
    // 연월 표시 (2026-01 → 2026년 1월)
    const ym = notice.yearMonth;
    const ymDisplay = ym ? `${ym.slice(0,4)}년 ${parseInt(ym.slice(5,7))}월` : '';
    yearMonthEl.textContent = ymDisplay;
    
    // 제목
    titleEl.textContent = notice.title;
    
    // 내용
    textEl.innerHTML = linkify(notice.content || '');
    
    // 박스 표시
    noticeBox.classList.remove('hidden');
    
    // 내용 길이에 따라 더보기 버튼 표시 여부
    setTimeout(() => {
        if (textEl.scrollHeight > 60) {
            wrapper.classList.add('max-h-[3.6rem]');
            gradient.classList.remove('hidden');
            toggleBtn.classList.remove('hidden');
            toggleBtn.innerHTML = '<span>더 보기</span> <i class="fas fa-chevron-down"></i>';
        } else {
            wrapper.classList.remove('max-h-[3.6rem]');
            gradient.classList.add('hidden');
            toggleBtn.classList.add('hidden');
        }
    }, 50);
}

// 지난 공지사항 모달 열기
function openNoticeHistory() {
    const modal = document.getElementById('notice-history-modal');
    const content = document.getElementById('notice-history-content');
    
    modal.classList.remove('hidden');
    
    if (allNotices.length === 0) {
        content.innerHTML = '<div class="text-center text-slate-400 py-10"><i class="fas fa-inbox text-4xl mb-3"></i><p>공지사항이 없습니다.</p></div>';
        return;
    }
    
    // 공지 목록 렌더링
    let html = '<div class="space-y-3">';
    allNotices.forEach((notice, index) => {
        const ym = notice.yearMonth;
        const ymDisplay = ym ? `${ym.slice(0,4)}년 ${parseInt(ym.slice(5,7))}월` : '';
        const isLatest = index === 0;
        
        html += `
            <div onclick="showNoticeDetail(${index})" class="bg-slate-800 hover:bg-slate-700 rounded-xl p-4 cursor-pointer transition-all border border-slate-700 hover:border-amber-500/50">
                <div class="flex items-center justify-between mb-1">
                    <span class="text-amber-500 text-xs font-bold">${ymDisplay}</span>
                    ${isLatest ? '<span class="bg-amber-500 text-slate-900 text-[10px] font-bold px-2 py-0.5 rounded-full">최신</span>' : ''}
                </div>
                <h4 class="text-white font-bold">${notice.title}</h4>
            </div>
        `;
    });
    html += '</div>';
    
    content.innerHTML = html;
}

// 공지사항 상세 보기
function showNoticeDetail(index) {
    const notice = allNotices[index];
    const content = document.getElementById('notice-history-content');
    
    const ym = notice.yearMonth;
    const ymDisplay = ym ? `${ym.slice(0,4)}년 ${parseInt(ym.slice(5,7))}월` : '';
    
    content.innerHTML = `
        <div>
            <button onclick="openNoticeHistory()" class="text-amber-500 hover:text-amber-400 text-sm font-bold mb-4 flex items-center gap-1">
                <i class="fas fa-arrow-left"></i> 목록으로
            </button>
            
            <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-3">
                    <span class="text-amber-500 text-xs font-bold">${ymDisplay}</span>
                </div>
                <h3 class="text-xl font-bold text-white mb-4">${notice.title}</h3>
                <div class="text-slate-300 text-sm leading-relaxed whitespace-pre-line benefit-text">
                    ${linkify(notice.content || '')}
                </div>
            </div>
        </div>
    `;
}

// 지난 공지사항 모달 닫기
function closeNoticeHistory() {
    document.getElementById('notice-history-modal').classList.add('hidden');
}

// 로그아웃 함수
function logout() {
    sessionStorage.removeItem('loggedInUser');
    window.location.href = '/';
}

    </script>

    <!-- 지난 공지사항 모달 -->
    <div id="notice-history-modal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-900 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden border border-slate-700 shadow-2xl">
            <!-- 모달 헤더 -->
            <div class="bg-slate-800 px-6 py-4 border-b border-slate-700 flex items-center justify-between">
                <h3 class="text-lg font-bold text-white flex items-center gap-2">
                    <i class="fas fa-history text-amber-500"></i> 지난 공지사항
                </h3>
                <button onclick="closeNoticeHistory()" class="text-slate-400 hover:text-white text-xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- 공지 목록 / 상세 내용 -->
            <div id="notice-history-content" class="p-6 overflow-y-auto max-h-[60vh]">
                <div class="text-center text-slate-400 py-10">
                    <i class="fas fa-circle-notch fa-spin text-2xl mb-2"></i>
                    <p>공지사항을 불러오는 중...</p>
                </div>
            </div>
        </div>
    </div>

</body>
</html>